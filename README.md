# Описание репозитория
Здесь собраны наработки по построению модели, 
которая восстанавливает вероятности исходов событий  
футбольного матча. На вход модели подается 6 значений:
1. Значение половинчатого тотала 
2. Кэф на тотал меньше (грязный)
3. Кэф на тотал больше (грязный)
4. Значение половинчатого гандикапа победы домашней команды
5. Кэф на гандикап домашней команды (грязный)
6. Кэф на противоположный гандикап выездной команды (грязный) 

## Структура репозитория
- [./optimizers.py]() - поиск параметров распределений 
Пуассона и Скеллама
- [./odds.py]() - моделирование букмекерской линии
- [./tests/*]() - тестовые запуски отдельных подзадач

# Алгоритм расчёта коэффициентов


# Эксперименты и выводы

- [./experiments/margins.ipynb]() - итоговые формулы маржи, которые
искали длительное время. Как оказалось, обе формулы дают одинаковые
вероятности из кэфов после очищения от маржи.
- [./experiments/skellam_system_solver.ipynb]() - попытка добавить
кэф на ничью как модификационный параметр, чтобы модельное распределение 
Скеллама лучше аппроксимировало именно ничейный исход
- []
- <a name="a"></a> [./experiments/handicap_polyfit.ipynb]()
 
Если смотреть суммарно, то есть несколько причин, из-за которых
не удается увеличить точность модели:
1. Противоречивые вероятности на одни и те же исходы, но взятые 
из разных событий - уже здесь содержится ошибка, которую модель 
никак победить не сможет.
2. Графики, полученные для тоталов и гандикапов в экспериментах.
Особое внимание привлекает расположение значений 
вероятности исходов относительно модельных вероятностей 
(для гандикапов и тоталов). Нет какой-то систематической
ошибки - модель для разных матчей может выдавать вероятность исхода 
как выше, чем в кэфе, так и ниже. В среднем, наши формулы повторяют
тренды, в изменениях кэфов, но повторить в точности не удается 
гипотетически из-за того, что нагрузка линии уникальная 
на каждый матч. 
3. Коэффициенты аппроксимирующего полинома, которые получаются 
при восстановлении зависимости между целыми, четвертичными 
и половинчатыми исходами ([здесь](#a)).
Для каждого матча эти коэффициенты получаются уникальными, и их
не получается никак обобщить.
4. Из хорошего - алгоритм Nelder-Mead не требует расчёта производной,
что экспериментально обеспечивает более стабильную сходимость, 
меньше плюется warning'ами. Но значения mu, mu1, mu2, как правило,
не сильно отличаются от старого алгоритма.